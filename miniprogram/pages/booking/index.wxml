<!-- booking/index.wxml -->
<view class="container">
  <!-- 头部导航栏 -->
  <view class="header-nav">
    <view class="nav-left">
      <view class="nav-btn" bindtap="switchStore">
        <text class="iconfont icon-store"></text>
        <text>{{switchStoreText}}</text>
      </view>
    </view>
    <view class="nav-center">
      <view class="nav-btn" bindtap="showQRCode">
        <text class="iconfont icon-qrcode"></text>
        <text>{{entranceCodeText}}</text>
      </view>
    </view>
    <view class="nav-right">
      <text class="page-title">{{bookingText}}</text>
    </view>
  </view>

  <!-- 课程类型筛选 -->
  <view class="course-type-tabs">
    <view class="type-tab {{currentType === 'regular' ? 'active' : ''}}" bindtap="switchCourseType" data-type="regular">
      <text>{{regularCourseText}}</text>
    </view>
    <view class="type-tab {{currentType === 'private' ? 'active' : ''}}" bindtap="switchCourseType" data-type="private">
      <text>{{privateCourseText}}</text>
    </view>
    <view class="type-tab {{currentType === 'intensive' ? 'active' : ''}}" bindtap="switchCourseType" data-type="intensive">
      <text>{{intensiveCourseText}}</text>
    </view>
  </view>

  <!-- 日期选择 -->
  <view class="date-selector">
    <scroll-view scroll-x="true" class="date-scroll">
      <view class="date-item {{currentDate === item.date ? 'active' : ''}}" 
            wx:for="{{dateOptions}}" 
            wx:key="date"
            bindtap="selectDate" 
            data-date="{{item.date}}">
        <text class="date-week">{{item.week}}</text>
        <text class="date-day">{{item.day}}</text>
        <text class="date-month">{{item.month}}</text>
      </view>
    </scroll-view>
  </view>

  

  <!-- 课程列表 -->
  <view class="course-list" wx:if="{{!loading && courses.length > 0}}">
    <view class="course-item" wx:for="{{courses}}" wx:key="courseId">
      <!-- 紧张状态标签 - 放在左上角 -->
      <view class="status-badge tense corner-left" wx:if="{{item.isTense}}">
        <text class="badge-icon">🔥</text>
        <text class="badge-text">{{tenseText}}</text>
      </view>
      
      <view class="course-time">
        <text class="time-range">{{item.startTime}}–{{item.endTime}}</text>
      </view>
      
      <view class="course-content">
        <view class="teacher-info">
          <image class="teacher-avatar" src="{{item.teacherAvatar}}" mode="aspectFill"></image>
          <text class="teacher-name">{{item.teacherName}}</text>
        </view>
        <view class="course-details">
          <text class="course-name">{{item.courseName}}</text>
          <text class="course-type">{{item.danceTypeName}}–{{item.courseLevel}}</text>
        </view>
      </view>
      
      <view class="booking-info">
        <view class="booking-status">
          <text class="booking-count">已预约{{item.bookedCount}}/{{item.capacity}}</text>
        </view>
        
        <!-- 预约按钮或状态标签 -->
        <view class="booking-action">
          <!-- 已满员 - 显示灰色按钮 -->
          <block wx:if="{{item.isFull}}">
            <button class="book-btn disabled" disabled>
              {{fullyBookedText}}
            </button>
          </block>
          
          <!-- 可以预约 -->
          <block wx:elif="{{item.canBook}}">
            <button class="book-btn" bindtap="bookCourse" data-course-id="{{item.courseId}}">
              {{bookText}}
            </button>
          </block>
          
          <!-- 未开放预约 -->
          <block wx:else>
            <button class="book-btn disabled" disabled>
              {{item.bookingOpenTime}}{{bookingOpenText}}
            </button>
          </block>
        </view>
      </view>
    </view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading">
      <text>{{loadingText}}</text>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-container" wx:if="{{!loading && courses.length === 0}}">
    <view class="empty">
      <text class="empty-icon">📅</text>
      <text class="empty-text">{{noCoursesText}}</text>
      <button class="empty-action-btn" bindtap="navigateToCourseList">
        {{viewAllCoursesText}}
      </button>
    </view>
  </view>
</view>